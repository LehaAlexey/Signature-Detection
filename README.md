# Signature Detector (минимальный)

Проект по КЗ.
Суть: обучаем детектор подписей, потом ищем bbox и чистим фон с помощью нахождения перцентиля объектов.

## Установка
```
python -m venv .venv
.\.venv\Scripts\activate
pip install -r requirements.txt
```

## Предсказание (CLI)
```
python predict.py --model runs/detect/train/weights/best.pt --image path\to\image.jpg --clean
```

## FastAPI сервис
```
uvicorn app:app --host 0.0.0.0 --port 8000
```

Пример:
```
curl -X POST "http://localhost:8000/predict/image?conf=0.15&clean=true" -F "file=@path/to/image.jpg"
```

## UI
```
python app.py
```

## Про очистку
Очистка фона — это вечная проблема. Один алгоритм срабатывает на одних сканах и ломается на других.
Сейчас стоит максимально простой вариант: бинаризация через Otsu, а потом удаление самых маленьких
связных компонентов по площади. Это не идеально: тонкие росчерки иногда страдают, а мелкий мусор
иногда остается. Поэтому я добавил параметр `clean_area_percentile`, его можно крутить и смотреть,
где становится лучше

## Параметры
- `clean=true` включает очистку фона на обрезках.
- `clean_area_percentile` задает порог удаления маленьких компонентов (0-100).
- `grayscale_inference=true` включает прогон изображения через grayscale.
- `параметры инференса` настройка прогона модели детекции. Не очень частый в настройке параметр с точки зрения UX, но тоже нужен
